本Lab相较于Lab1，难度有所降低。就最核心的问题进行讨论：**线性一致性**问题。

## 线性一致性 / Linearizability
当什么情况下会需要到线性一致性呢？先来看一个场景：对于一个单体服务有多个客户端，其中某个客户端和服务之间发生单向网络错误。客户端识别到并重新发出请求，如何保证这个请求对于服务来说是只被执行一次的呢？（全局唯一性）

发生错误分为两种类型：
- TOS错误：服务端没有接收到客户端的请求；
- TOC错误：客户端没有接收到服务端的响应。

对于第一种情况，情况还算比较容易处理，客户端不断重新发送请求即可；但对于第二种情况，就需要保证客户端的请求在服务端是线性一致性的。

### 如何实现？
线性一致性的实现分为两个部分：
- 请求携带信息
- 服务端缓存响应。

**请求携带信息**，客户端发送的请求需要携带客户端标识和请求序列号；客户端标识用来做缓存的Key值，请求序列号用来检测是否是重复请求。

**服务端缓存响应**，服务端将响应以客户端标识-响应的KV形式缓存起来，供容错返回